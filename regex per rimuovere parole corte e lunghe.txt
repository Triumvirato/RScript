# remove all strings longer than 15 characters
  remove.long.terms = function(x, max.length)
  {
    return(PlainTextDocument(paste(sapply(strsplit(as.character(x), " "),
                                          function(y)
                                          {
                                            ifelse(nchar(y) > max.length, "", y)
                                          }
    ), collapse = " ")))
  }
  corpus <- tm_map(corpus, remove.long.terms,max.length=15)
  
  # remove all strings shorter than 3 characters
  remove.short.terms = function(x, min.length)
  {
    return(PlainTextDocument(paste(sapply(strsplit(as.character(x), " "),
                                          function(y)
                                          {
                                            ifelse(nchar(y) <= min.length, "", y)
                                          }
    ), collapse = " ")))
  }
  corpus <- tm_map(corpus, remove.short.terms,min.length=3)